<!DOCTYPE HTML>
<html>
  <head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<meta name="renderer" content="webkit|ie-comp|ie-stand">
	<meta name="keywords" content="scclui框架">
	<meta name="description" content="scclui为轻量级的网站后台管理系统模版。">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta http-equiv="Cache-Control" content="no-siteapp" />
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
	<link href="/static/css/bootstrap-table.css" rel="stylesheet">
    <link href="/static/css/uploadify.css" rel="stylesheet">
	<script type="text/javascript" src="/static/js/basic/jquery.js"></script>
	<script type="text/javascript" src="/static/js/basic/bootstrap.min.js"></script>
	<script type="text/javascript" src="/static/js/basic/bootstrap-table.js"></script>
	<script type="text/javascript" src="/static/js/basic/bootstrap-table-zh-CN.js"></script>
    <script type="text/javascript" src="/static/js/basic/jquery.uploadify.min.js"></script>
    <title>基础信息</title>

  </head>

  <body>
    <div class="panel-body">
        <div class="row">
            <div class="col-lg-6">
            <legend><i class="fa  fa-paper-plane"></i>正向发布</legend>
                <form  id="deployadd" class="main form-horizontal" >
                    <fieldset>
                        <div class="form-group" >
                                <label class="col-sm-2 control-label">发布项目</label>
                                <div class="col-sm-6">
                                    <select class="form-control" name="web_project" id="web_project">

                                    </select>
                                </div>
                        </div>
                        <div class="form-group">
                             <label class="col-sm-2 control-label" >版本号</label>
                             <div class="col-sm-6">
                               <input id="deploy_version"  class="form-control" placeholder="输入版本号" name="deploy_version" value="">
                             </div>
                        </div>

                        </fieldset>
                        <legend></legend>
                        <div class="form-group">
                            <label class="col-sm-3 control-label"></label>
                            <button type="button"  class="btn btn-default" onclick="runAnsibleModel(this)" >执行</button>
                        </div>
                    </form>
                    <form  id="upload_file" class="main form-horizontal" method="POST" enctype="multipart/form-data">
                    <fieldset>
                        <input type="file" id="war" name="war">
                        <input type="submit">
                    </fieldset>
                    </form>
                <div class="progress" style="display: none;">
                    <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
                        0%
                    </div>
                </div>

            </div>
            <!-- /.col-lg-6 (nested) -->
            <div class="col-lg-6">
                <legend><i class="fa  fa-paper-plane-o"></i>执行结果</legend>
                <pre>
                    <div id="result">
                    </div>
                </pre>
            <!-- /.col-lg-6 (nested) -->
            </div>
        <!-- /.row (nested) -->
        </div>
        <!-- /.panel-body -->
        </div>
        <!-- /.panel -->



	<script type="text/javascript">
    $('form').on('submit', function (event) {
        // 显示进度条
        $('.progress').css('display', 'block');
        // 阻止元素发生默认的行为，此处用来阻止对表单的提交
        event.preventDefault();
        var formData = new FormData(this);
        // jQuery Ajax 上传文件，关键在于设置：processData 和 contentType
        $.ajax({
            xhr: function () {
                var xhr = new XMLHttpRequest();
                xhr.upload.addEventListener('progress', function (e) {
                    if (e.lengthComputable) {
                        var percent = Math.round(e.loaded * 100 / e.total);
                        $('.progress-bar').attr('aria-valuenow', percent).css('width', percent + '%').text(percent + '%');
                    }
                });
                return xhr;
            },
            type: 'POST',
            url: '/upload_file',
            cache: false,
            data: formData,
            // 告诉 jQuery 不要去处理发送的数据
            processData: false,
            // 告诉 jQuery 不要去设置 Content-Type 请求头
            // 因为这里是由 <form> 表单构造的 FormData 对象，且已经声明了属性 enctype="multipart/form-data"，所以设置为 false
            contentType: false
        }).done(function (res) {
            alert('上传成功!');
        }).fail(function (res) {
            alert('上传失败!');
        });
    });
</script>

  </body>

</html>
